<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Calendario · Musicala</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light" />

  <!-- Estilos base -->
  <link rel="stylesheet" href="styles.css" />

  <!-- Fuente (Manual Musicala: Roboto / fallback Inter si ya la usas) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600;800;900&display=swap"
    rel="stylesheet"
  />
</head>

<body>
  <!-- ======================
       HEADER
  ======================= -->
  <header class="header">
    <div class="header-left">
      <!-- Marca -->
      <div class="brand">
        <img
          src="./logo.png"
          alt="Musicala"
          class="brand-logo"
        />
        <div class="brand-text">
          <span class="brand-title">Calendario</span>
          <span class="brand-subtitle">Musicala</span>
        </div>
      </div>

      <span id="userEmail" class="user-email hidden"></span>
    </div>

    <div class="header-right">
      <button id="btnLogin" class="btn primary">Iniciar sesión</button>
      <button id="btnLogout" class="btn ghost hidden">Salir</button>
    </div>
  </header>

  <!-- ======================
       BLOQUE NO AUTORIZADO
  ======================= -->
  <section id="unauthorized" class="unauthorized hidden">
    <p>
      Este calendario es de uso interno.<br />
      Si crees que deberías tener acceso, revisa el correo con el que iniciaste sesión.
    </p>
  </section>

  <!-- ======================
       APP PRINCIPAL
  ======================= -->
  <main id="app" class="app hidden">

    <!-- Toolbar -->
    <section class="toolbar">
      <div class="toolbar-left">
        <button id="btnPrevMonth" class="btn ghost" type="button">◀</button>
        <h2 id="currentMonth">Mes Año</h2>
        <button id="btnNextMonth" class="btn ghost" type="button">▶</button>
      </div>

      <div class="toolbar-right">
        <button id="btnToday" class="btn ghost" type="button">Hoy</button>
        <button id="btnNewEvent" class="btn primary" type="button">＋ Nuevo evento</button>
      </div>
    </section>

    <!-- ======================
         Panel Hoy / Próximos 7
    ======================= -->
    <section class="overview" aria-label="Resumen">
      <div class="overview-card" id="overviewToday">
        <div class="overview-title">Hoy</div>
        <div class="overview-body" id="todayList">
          <span class="muted">Sin eventos</span>
        </div>
      </div>

      <div class="overview-card" id="overviewNext">
        <div class="overview-title">Próximos 7 días</div>
        <div class="overview-body" id="nextList">
          <span class="muted">Sin eventos</span>
        </div>
      </div>
    </section>

    <!-- ======================
         Búsqueda + Modo vista
    ======================= -->
    <section class="controls" aria-label="Controles">
      <div class="controls-left">
        <input
          id="searchEvents"
          type="text"
          placeholder="Buscar por título o notas…"
          autocomplete="off"
          spellcheck="false"
        />
      </div>

      <div class="controls-right" role="tablist" aria-label="Vista">
        <button id="btnViewMonth" class="seg active" type="button" aria-selected="true">
          Mes
        </button>
        <button id="btnViewList" class="seg" type="button" aria-selected="false">
          Lista
        </button>
      </div>
    </section>

    <!-- Filtros -->
    <section class="filters">
      <select id="filterCategory">
        <option value="">Todas las categorías</option>
      </select>

      <select id="filterStatus">
        <option value="">Todos los estados</option>
        <option value="pending">Pendiente</option>
        <option value="done">Hecho</option>
        <option value="cancelled">Cancelado</option>
      </select>
    </section>

    <!-- ======================
         Vista Mes (Calendario)
    ======================= -->
    <section class="calendar" id="monthView">
      <div class="calendar-grid" id="calendarGrid">
        <!-- días y eventos se renderizan por JS -->
      </div>
    </section>

    <!-- ======================
         Vista Lista
    ======================= -->
    <section class="list-view hidden" id="listView" aria-label="Lista de eventos">
      <div class="list-head">
        <h3 id="listTitle">Eventos</h3>
      </div>
      <div class="list-body" id="listBody">
        <!-- items se renderizan por JS -->
      </div>
    </section>

  </main>

  <!-- ======================
       MODAL EVENTO
  ======================= -->
  <div id="eventModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-content">
      <h3 id="modalTitle">Nuevo evento</h3>

      <form id="eventForm">
        <label>
          Título
          <input type="text" id="eventTitle" required />
        </label>

        <label>
          Categoría
          <select id="eventCategory" required></select>
        </label>

        <label>
          Fecha
          <input type="date" id="eventDate" required />
        </label>

        <label>
          Estado
          <select id="eventStatus">
            <option value="pending">Pendiente</option>
            <option value="done">Hecho</option>
            <option value="cancelled">Cancelado</option>
          </select>
        </label>

        <label>
          Notas
          <textarea id="eventNotes" rows="3"></textarea>
        </label>

        <div class="modal-actions">
          <button type="button" id="btnDeleteEvent" class="btn danger hidden">
            Eliminar
          </button>

          <div class="modal-actions-right">
            <button type="button" id="btnCancelModal" class="btn ghost">
              Cancelar
            </button>
            <button type="submit" class="btn primary">
              Guardar
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- ======================
       OVERLAY MODAL
  ======================= -->
  <div id="modalOverlay" class="overlay hidden"></div>

  <!-- ======================
       SCRIPTS
  ======================= -->
  <!-- Firebase core -->
  <script type="module" src="js/firebase.js"></script>
  <script type="module" src="js/auth.js"></script>

  <!-- App -->
  <script type="module" src="js/constants.js"></script>
  <script type="module" src="js/utils.js"></script>
  <script type="module" src="js/db.js"></script>
  <script type="module" src="js/ui.js"></script>
  <script type="module" src="js/app.js"></script>
</body>
</html>
